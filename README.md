# Logo Error Checker Project

Проект Logo Error Checker представляет собой систему для обнаружения и классификации ошибок в брендировании национальных проектов на изображениях. Система использует различные модели машинного обучения для анализа изображений, распознавания текста, поиска людей и проверки цвета.

## Идея проекта

Цель проекта - создать инструмент, который поможет автоматически проверять изображения на соответствие требованиям брендирования национальных проектов. Это позволит существенно сократить время, затрачиваемое на ручную проверку изображений, и повысить точность проверки.

## Структура проекта

### `app/`

Директория `app` содержит весь исходный код для запуска и работы проекта, включая API, Telegram-бота, машинное обучение и пользовательский интерфейс.

- `api/`

  - `__init__.py`
  - `api.py`: Реализация FastAPI для взаимодействия с внешними приложениями.

- `bot/`

  - `__init__.py`
  - `telegram_bot.py`: Код для Telegram-бота, использующего aiogram для обработки сообщений и взаимодействия с пользователями.

- `ml/`

  - `__init__.py`
  - `weights/`: Директория, содержащая веса моделей.
  - `classification_crop.py`: Модель классификации изображений.
  - `classification_direction.py`: Модель классификации направлений.
  - `color_checker.py`: Модель проверки цвета.
  - `logo_detector.py`: Модель обнаружения логотипов.
  - `ml.py`: Основной файл для интеграции всех моделей и проверок.
  - `ocr.py`: Модель распознавания текста.
  - `search_people.py`: Модель поиска людей на изображениях.

- `ui/`

  - `__init__.py`
  - `layout.py`: Код для Streamlit-приложения, позволяющего загружать изображения и получать результаты классификации.
  - `logo.png`: Логотип для отображения в пользовательском интерфейсе.

- `utils/`

  - `__init__.py`
  - `utils.py`: Вспомогательные функции и утилиты для проекта.

- `main.py`: Основной файл для запуска Streamlit-приложения, Telegram-бота и API.

### `data/`

Директория `data` содержит все фотографии, используемые для обучения и тестирования моделей.

#### Структура

- `classification_crop/`: Изображения для обучения и тестирования модели классификации изображений.
- `classification_direction/`: Изображения для обучения и тестирования модели классификации направлений.
- `direction/`: Дополнительные изображения для классификации направлений.
- `detection_all/`: Изображения для обнаружения всех объектов.
- `original/`: Оригинальные изображения для различных задач классификации и обнаружения.

### `train/`

Директория `train` содержит Jupyter ноутбуки, используемые для подбора весов моделей и их обучения.

#### Структура

- `classification_crop/`
  - `train.ipynb`: Ноутбук для обучения модели классификации изображений.
- `classification_direction/`
  - `1.ipynb`: Ноутбук для обучения модели классификации направлений.
- `ocr/`
  - `ocr.ipynb`: Ноутбук для обучения модели распознавания текста.
- `znak_detection/`
  - `yolo_detection.ipynb`: Ноутбук для обучения модели обнаружения логотипов.

## Установка

1. Клонируйте репозиторий:

```bash
git clone https://github.com/simeonkolchin/hack_22_06_24_school_of_programming
cd logo-error-checker
```

2. Установите необходимые библиотеки:

```bash
pip install -r requirements.txt
```

## Запуск проекта

Для запуска проекта выполните одну/все команду(ы) из корневой директории:

Запуск телеграм-бота:

```bash
set PYTHONPATH=%cd%
python app\bot\telegram_bot.py
```

Запуск приложения streamlit:

```bash
streamlit run app/ui/layout.py
```

Запуск API:

```bash
uvicorn app.api:app --reload
```

# Использование API

## Базовый URL

```arduino
http://<your_server_ip>:8000
```

## Эндпоинты

### Проверка ошибок на изображении

```bash
POST /check_errors/
```

Описание: Загружает изображение и возвращает список обнаруженных ошибок.

Параметры запроса:

- file: Файл изображения (обязательный параметр).

## Пример запроса:

```http
POST /check_errors/ HTTP/1.1
Host: <your_server_ip>:8000
Content-Type: multipart/form-data
Content-Length: <length>
Content-Disposition: form-data; name="file"; filename="example.jpg"
```

## Пример ответа:

```json
{
  "errors": [],
  "ocr_class": "some_class",
  "bbox_results": [
    {
      "bbox": [36, 2, 313, 246],
      "cropped_class": "some_class",
      "errors": ["Неправильное направление"],
      "ocr_class": "some_class",
      "color_class": "some_color"
    }
  ]
}
```

# Примеры использования

## Python

```python
import requests

url = "http://<your_server_ip>:8000/check_errors/"
file_path = "path_to_your_image.jpg"

with open(file_path, "rb") as image_file:
    files = {"file": image_file}
    response = requests.post(url, files=files)

if response.status_code == 200:
    print("Errors detected:", response.json().get("errors"))
else:
    print("Failed to check errors:", response.status_code)
```

## cURL

```cURL
curl -X POST "http://<your_server_ip>:8000/check_errors/" -F "file=@path_to_your_image.jpg"
```

## JavaScript (Fetch API)

```javascript
async function checkErrors(imageFile) {
  const url = 'http://<your_server_ip>:8000/check_errors/';
  const formData = new FormData();
  formData.append('file', imageFile);

  const response = await fetch(url, {
    method: 'POST',
    body: formData,
  });

  if (response.ok) {
    const data = await response.json();
    console.log('Errors detected:', data.errors);
  } else {
    console.error('Failed to check errors:', response.status);
  }
}

// Пример использования
const imageFile = document.querySelector('input[type="file"]').files[0];
checkErrors(imageFile);
```

## Контакты

Если у вас возникли вопросы или предложения, вы можете связаться с нами по электронной почте [simeonkolchin@gmail.com].

# Кейсо держатель и наименование кейса

## Кейсодержатель: Департамент экономики Тюменской области

## Наименование кейса: Брендирование национальных проектов

## Описание проблемы (актуальность решения)

На данный момент правильность брендирования национальных проектов выполняется людьми, что занимает много времени. Требуется создать нейронную сеть, которая бы распознавала брендирование на фотографии и относила ее к одному из национальных проектов.

## Требования к решению

Форма: Нейронная сеть (телеграмм-бот)

## Требования к продукту:

- Пользователь загружает фотографии брендированных объектов или мероприятий.
- Нейросеть должна распознать, к какому из национальных проектов относится каждая из фотографий.
- Брендирование на фотографии должно быть проверено нейронной сетью на соответствие требованиям к брендированию данного национального проекта:
- должен использоваться шрифт Roboto, начертание Bold – для заголовков, Medium – для заголовков и подзаголовков, Regular – для основного текста, Light – для поясняющего текста.
- Единый логотип национальных проектов – луч, который символизирует позитивные изменения «здесь и сейчас». Логотип выполнен в стиле конструктивизма. Единственно возможный вид луча. Обратное отображение луча для брендирования объектов и результатов национальных проектов запрещено.
- Каждый из национальных проектов имеет фирменные цвета. Приложенные на фотографии ниже (доступны по ссылке ниже).
- фотографии забрендированных объектов и результатов национальных проектов предоставляются в формате растровых изображений (вертикальные и горизонтальные) в формате .jpeg;
- В кадре должны отсутствовать люди.
- Фотографии, на которых отсутствует брендирование или нарушены обозначенные выше правила, должны быть помечены как неподходящие.
- По каждой из фотографий должно быть отправлено сообщение с информацией о типе национального проекта, а также о выполнении требований к фотографии пользователю, подгрузившему фото. В случае если фотография неподходящая, пользователю направляется сообщение о причине (какое из требований нарушено) или просто уведомление о некорректности.
